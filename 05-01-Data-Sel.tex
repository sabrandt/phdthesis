\chapter{Data Samples and Event Selection}\label{ch:data}
The data used in this analysis were collected in late 2017 by the CMS Experiment during Run II of the LHC. At this time, the LHC delivered two sets of \pp collisions, at \serag (2017G) and at \serah (2017H). This chapter details the information related to data collection and Monte Carlo simulations associated with these data taking periods. Details regarding the object identification criteria and event selection are also provided.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%     Dataset 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Datasets}\label{ch:data:dataset}
Data used in this analysis are from the LHC run eras 2017G and 2017H, consisting of \pp collisions at \serag with integrated luminosity $\mathcal{L}=\lumig$ and \serah with integrated luminosity $\mathcal{L}=\lumih$, respectively. Names of the data streams and relevant run era and reconstruction version identifications are listed in Table~\ref{tab:dataset13} and Table~\ref{tab:dataset5}. 
\input{tables/Data/tab-datastream.tex}

\section{Triggers}\label{ch:data:triggers}
All events considered must have at least one lepton selected by the relevant trigger path. For muons, the kinematic requirement is $\pt>17\GeV$ and $|\eta|<2.4$ for both \serag and \serah. For electrons, the kinematic requirement is $\pt>20\GeV$ ($\pt>17\GeV$) and $|\eta|<2.5$ for \serag (\serah). Additional isolation and reconstruction quality criteria, which are less restrictive than the offline selection criteria, are applied at the trigger level. Names of the trigger paths are listed in  Table~\ref{tab:triggers}

\input{tables/Data/tab-triggers.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%     Lumi Calibration 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Luminosity}\label{ch:lumi}
Data used for physics analyses are required to pass the quality certification regarding operation of detector subsystems during the data taking period. 
% The list of data taking periods with highest quality requirements are compiled into a good run list .
% The JSON files containing the selected data segments for 2017G (\serag) and 2017H (\serah) are: \\
% \centerline{\texttt{\small Cert\_306546-306826\_5TeV\_EOY2017ReReco\_Collisions17\_JSON.txt}}
% \centerline{\texttt{\small Cert\_306896-307082\_13TeV\_PromptReco\_Collisions17\_JSON\_LowPU\_lowPU.txt}}
%
The 2017G and 2017H data taking periods are notable for the LHC conditions producing very few additional collisions in the concurrent or adjacent bunch crossings. These additional collisions are referred to as pileup events. Pileup conditions during the data taking periods are shown in Figure~\ref{fig:data:lumiPU13}, with an average of $\langle\mu\rangle=3$ collisions per bunch crossing. The instantaneous luminosity per day is shown in Figure~\ref{fig:data:lumiperday5}. Uncertainties on the luminosity measurement are 1.7\% (3.5\%) for the certified data at \serah (\serag). The total integrated luminosity collected by the data streams during \serag and \serah are listed in Table~\ref{tab:lumis}~\cite{LumiPOGNumbers}.
\input{plots/Data/fig-lumi-PU.tex}
\input{plots/Data/fig-lumi-day.tex}
\input{tables/Data/tab-lumi.tex}

%% Is there a specific thing to cite if you use brilcalc to get the lumi out of the trigger path


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%     Simulated Samples & info 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Simulated samples}\label{ch:data:sim}
Several simulated Monte Carlo (MC) samples are used in the descriptions of signal and background processes. The \Wpm and \Z boson signal events are simulated at next-to-leading order (NLO) with up to two outgoing partons at Born level by \MGvATNLO~2.3.3~\cite{Alwall:2014hca}. An additional set of simulations of the \Wpm and \Z boson signal processes are provided at NLO by \POWHEG~2.0~\cite{Alioli:2008gx,Frixione:2007vw,powheg:2010,Alioli:2010xd} for the \Wpm and \MINLO~\cite{Hamilton:2012rf} for the \Z boson. Background samples (di-boson and \ttbar) are also simulated with \POWHEG~2.0. Underlying event modeling, parton showering, hadronization, and final state radiation are done by \PYTHIA~8.230~\cite{Sjostrand:2014zea}, using tune CP5~\cite{Sirunyan:2019dfx} and default parton distribution functions (PDFs) provided by NNPDF3.1~\cite{Ball:2017nwa}. Primary sample names and their respective production cross sections are listed in Table~\ref{tab:allSamples5} (Table~\ref{tab:allSamples13}) for \serag (\serah).

The distribution of pileup interactions is simulated to match the corresponding conditions in data. For all simulated samples, simulation of detector response is performed by \GEANTfour~\cite{Agostinelli:2002hh}, with full event reconstruction being done using the same algorithms used to reconstruct data. Object and event reconstruction was described in Chapter~\ref{ch:reco}. 

\input{tables/Data/tab-mc.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%     Event Selection
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Event Selection \& Fiducial Region}
 \subsubsection{Reconstructed}
Preliminary \Wpm and \Z boson event candidates are identified by the presence of at least one lepton identified by the single electron and single muon triggers described in Section~\ref{ch:data:triggers}. These are further selected by applying the offline electron or muon reconstruction identification criteria described in Section~\ref{ch:IdIso}. 
A \Z boson event requires the presence a pair of oppositely charged leptons ($e^{+}e^{-}$ or $\mu^{+}\mu^{-}$), at least one of the leptons being identified by the trigger, and each of the leptons fulfilling the ID requirements in Section~\ref{ch:IdIso}, and an invariant mass of \masswindow. 
Selection of a \Wp or \Wm boson candidate requires one charged lepton identified by the trigger and passing all ID requirements in Section~\ref{ch:IdIso}. A veto is applied to events containing additional leptons passing a loose identification requirement. 

% Additionally, \Wpm events are required to have an invariant mass $\mt > 40\GeV$, with \mt defined by: 
% $\mt = \sqrt{ 2 \pt \met ( 1 - \cos(\Delta\phi) ) }$, where $\Delta\phi$ is the angle between the lepton and \vmet in the transverse plane.

\subsubsection{Fiducial Region}
The fiducial region for the \Wpm and \Z boson acceptance at generator-level emulates the selection at reconstruction level. This requires kinematic cuts $\pt > 25 \GeV$ and $|\eta| < 2.4$ for all charged leptons. Additionally, the \Z boson fiducial region includes a requirement on the dilepton mass: \masswindow. The fiducial region for the \W boson includes the transverse mass requirement $\mt>40\GeV$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%     object definition
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Object Identification}\label{ch:IdIso}
The \W and \Z boson candidates are identified by the presence of one or two, respectively, well-identified leptons passing a strong set of criteria ensuring proper reconstruction and identification. This section contains a description of the identification requirements for the \wlnu and \zll signal leptons, as well as the requirements for the lepton veto for the \Wpm boson selection.

\subsection{Electrons}\label{ch:IdIso:Ele}
Electrons originating from a candidate \Wp, \Wm, and \Z bosons are required to pass the standard cut-based identification with medium working point. The thresholds for observables required to pass this requirement are listed in Table~\ref{tab:Data:Sel:Ele}~\cite{EgammaIDIsoCuts}. Descriptions of the observables are provided in Chapter~\ref{ch:reco:ele}. The \Wpm boson selection requires the absence of additional leptons in the event. The veto is performed with leptons fulfilling the loose working point identification requirements, with criteria for electrons listed in Table~\ref{tab:Data:Sel:EleVeto}. 

\input{tables/Data/tab-ele-id.tex}
\input{tables/Data/tab-ele-veto.tex}

\subsection{Muons}\label{ch:IdIso:Mu}
Muons originating from a candidate \Wpm or \Z boson are required to pass the standard cut-based identification with tight working point with tight working point requirement on the muon PF isolation. The thresholds for observables required to pass this requirement are listed in Table~\ref{tab:Data:Sel:Mu}~\cite{MuonIDIsoCuts}. Descriptions of the observables are provided in Chapter~\ref{ch:reco:mu}. As in the electron channel, the \Wpm boson selection requires the absence of additional leptons in an event which pass the loose cut-based ID. The criteria for muons is listed in Table~\ref{tab:Data:Sel:Mu:Veto}. 

\input{tables/Data/tab-mu-id.tex}
\input{tables/Data/tab-mu-veto.tex}

